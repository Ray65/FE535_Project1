install.packages("bizdays")
install.packages("openair")
install.packages("data.table")
require("bizdays")
require("openair")
library("data.table")
#source("DatasetGen.R")
#tail(MergedStockData)

#Calculating daily returns of each stock
AAPL_DailyReturns <- periodReturn(AAPL, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
AMZN_DailyReturns <- periodReturn(AMZN, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
JNJ_DailyReturns <- periodReturn(JNJ, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
BAC_DailyReturns <- periodReturn(BAC, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
ORCL_DailyReturns <- periodReturn(ORCL, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
XOM_DailyReturns <- periodReturn(XOM, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
GOOG_DailyReturns <- periodReturn(GOOG, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
WMT_DailyReturns <- periodReturn(WMT, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
PFE_DailyReturns <- periodReturn(PFE, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
JPM_DailyReturns <- periodReturn(JPM, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
T_DailyReturns <- periodReturn(T, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)
CVX_DailyReturns <- periodReturn(CVX, period = "daily", subset = NULL, type = "arithmetic", leading = TRUE)

#-------------------- Calculating annual mean returns of each stock --------------------
#Converting from xts objects to dfs
AAPL_DailyRetsDF <- data.frame(date=index(AAPL_DailyReturns), coredata(AAPL_DailyReturns))
AMZN_DailyRetsDF <- data.frame(date=index(AMZN_DailyReturns), coredata(AMZN_DailyReturns))
JNJ_DailyRetsDF <- data.frame(date=index(JNJ_DailyReturns), coredata(JNJ_DailyReturns))
BAC_DailyRetsDF <- data.frame(date=index(BAC_DailyReturns), coredata(BAC_DailyReturns))
ORCL_DailyRetsDF <- data.frame(date=index(ORCL_DailyReturns), coredata(ORCL_DailyReturns))
XOM_DailyRetsDF <- data.frame(date=index(XOM_DailyReturns), coredata(XOM_DailyReturns))
GOOG_DailyRetsDF <- data.frame(date=index(GOOG_DailyReturns), coredata(GOOG_DailyReturns))
WMT_DailyRetsDF <- data.frame(date=index(WMT_DailyReturns), coredata(WMT_DailyReturns))
PFE_DailyRetsDF <- data.frame(date=index(PFE_DailyReturns), coredata(PFE_DailyReturns))
JPM_DailyRetsDF <- data.frame(date=index(JPM_DailyReturns), coredata(JPM_DailyReturns))
T_DailyRetsDF <- data.frame(date=index(T_DailyReturns), coredata(T_DailyReturns))
CVX_DailyRetsDF <- data.frame(date=index(CVX_DailyReturns), coredata(CVX_DailyReturns))

#Getting annual data per year
#2004
AAPL_DailyRetsDF2004 <- selectByDate(AAPL_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
AMZN_DailyRetsDF2004 <- selectByDate(AMZN_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
JNJ_DailyRetsDF2004 <- selectByDate(JNJ_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
BAC_DailyRetsDF2004 <- selectByDate(BAC_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
ORCL_DailyRetsDF2004 <- selectByDate(ORCL_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
XOM_DailyRetsDF2004 <- selectByDate(XOM_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
GOOG_DailyRetsDF2004 <- selectByDate(GOOG_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
WMT_DailyRetsDF2004 <- selectByDate(WMT_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
PFE_DailyRetsDF2004 <- selectByDate(PFE_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
JPM_DailyRetsDF2004 <- selectByDate(JPM_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
T_DailyRetsDF2004 <- selectByDate(T_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")
CVX_DailyRetsDF2004 <- selectByDate(CVX_DailyRetsDF, start = "1/8/2004", end = "31/12/2004")

#2005
AAPL_DailyRetsDF2005 <- selectByDate(AAPL_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
AMZN_DailyRetsDF2005 <- selectByDate(AMZN_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
JNJ_DailyRetsDF2005 <- selectByDate(JNJ_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
BAC_DailyRetsDF2005 <- selectByDate(BAC_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
ORCL_DailyRetsDF2005 <- selectByDate(ORCL_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
XOM_DailyRetsDF2005 <- selectByDate(XOM_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
GOOG_DailyRetsDF2005 <- selectByDate(GOOG_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
WMT_DailyRetsDF2005 <- selectByDate(WMT_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
PFE_DailyRetsDF2005 <- selectByDate(PFE_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
JPM_DailyRetsDF2005 <- selectByDate(JPM_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
T_DailyRetsDF2005 <- selectByDate(T_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")
CVX_DailyRetsDF2005 <- selectByDate(CVX_DailyRetsDF, start = "1/1/2005", end = "31/12/2005")

#2006
AAPL_DailyRetsDF2006 <- selectByDate(AAPL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
AMZN_DailyRetsDF2006 <- selectByDate(AMZN_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JNJ_DailyRetsDF2006 <- selectByDate(JNJ_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
BAC_DailyRetsDF2006 <- selectByDate(BAC_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
ORCL_DailyRetsDF2006 <- selectByDate(ORCL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
XOM_DailyRetsDF2006 <- selectByDate(XOM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
GOOG_DailyRetsDF2006 <- selectByDate(GOOG_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
WMT_DailyRetsDF2006 <- selectByDate(WMT_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
PFE_DailyRetsDF2006 <- selectByDate(PFE_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JPM_DailyRetsDF2006 <- selectByDate(JPM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
T_DailyRetsDF2006 <- selectByDate(T_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
CVX_DailyRetsDF2006 <- selectByDate(CVX_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")

#2007
AAPL_DailyRetsDF2006 <- selectByDate(AAPL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
AMZN_DailyRetsDF2006 <- selectByDate(AMZN_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JNJ_DailyRetsDF2006 <- selectByDate(JNJ_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
BAC_DailyRetsDF2006 <- selectByDate(BAC_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
ORCL_DailyRetsDF2006 <- selectByDate(ORCL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
XOM_DailyRetsDF2006 <- selectByDate(XOM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
GOOG_DailyRetsDF2006 <- selectByDate(GOOG_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
WMT_DailyRetsDF2006 <- selectByDate(WMT_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
PFE_DailyRetsDF2006 <- selectByDate(PFE_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JPM_DailyRetsDF2006 <- selectByDate(JPM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
T_DailyRetsDF2006 <- selectByDate(T_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
CVX_DailyRetsDF2006 <- selectByDate(CVX_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")

#2008
AAPL_DailyRetsDF2006 <- selectByDate(AAPL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
AMZN_DailyRetsDF2006 <- selectByDate(AMZN_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JNJ_DailyRetsDF2006 <- selectByDate(JNJ_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
BAC_DailyRetsDF2006 <- selectByDate(BAC_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
ORCL_DailyRetsDF2006 <- selectByDate(ORCL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
XOM_DailyRetsDF2006 <- selectByDate(XOM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
GOOG_DailyRetsDF2006 <- selectByDate(GOOG_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
WMT_DailyRetsDF2006 <- selectByDate(WMT_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
PFE_DailyRetsDF2006 <- selectByDate(PFE_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JPM_DailyRetsDF2006 <- selectByDate(JPM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
T_DailyRetsDF2006 <- selectByDate(T_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
CVX_DailyRetsDF2006 <- selectByDate(CVX_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")

#2009
AAPL_DailyRetsDF2006 <- selectByDate(AAPL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
AMZN_DailyRetsDF2006 <- selectByDate(AMZN_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JNJ_DailyRetsDF2006 <- selectByDate(JNJ_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
BAC_DailyRetsDF2006 <- selectByDate(BAC_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
ORCL_DailyRetsDF2006 <- selectByDate(ORCL_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
XOM_DailyRetsDF2006 <- selectByDate(XOM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
GOOG_DailyRetsDF2006 <- selectByDate(GOOG_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
WMT_DailyRetsDF2006 <- selectByDate(WMT_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
PFE_DailyRetsDF2006 <- selectByDate(PFE_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
JPM_DailyRetsDF2006 <- selectByDate(JPM_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
T_DailyRetsDF2006 <- selectByDate(T_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")
CVX_DailyRetsDF2006 <- selectByDate(CVX_DailyRetsDF, start = "1/1/2006", end = "31/12/2006")




#cal <- create.calendar("Brazil/ANBIMA", holidaysANBIMA, weekdays=c("saturday", "sunday"))
#cal <- create.calendar(name='MyCalendar', weekdays=c('sunday', 'saturday'), adjust.from=adjust.next, adjust.to=adjust.previous)
#cal <- create.calendar(name='MyCalendar', weekdays=c('sunday', 'saturday'))
#dates_2004 = bizseq(as.Date("2004-08-02"), as.Date("2004-12-31"), "Brazil/ANBIMA")
#dates_2004 = bizseq(as.Date("2004-08-02"), as.Date("2004-12-31"), "MyCalendar")
#StockData_2004 <- MergedStockData[index(dates_2004)]
#dates_2005 = bizseq(as.Date("2005-01-01"), as.Date("2005-12-31"), "MyCalendar")
#StockData_2005 <- MergedStockData[index(dates_2005)]
